(window["webpackJsonp"]=window["webpackJsonp"]||[]).push([["chunk-7e83b537"],{1799:function(t,a,o){"use strict";var e=function(){var t=this,a=t.$createElement,o=t._self._c||a;return o("nav",{staticClass:"mt-3"},[o("ul",{staticClass:"pagination d-flex justify-content-center"},[o("li",{staticClass:"page-item",class:{disabled:!t.pagination.has_pre}},[o("a",{staticClass:"page-link",attrs:{href:"#","aria-label":"Previous"},on:{click:function(a){return t.goPage(t.pagination.current_page-1)}}},[o("span",{attrs:{"aria-hidden":"true"}},[t._v("«")])])]),t._l(t.pagination.total_pages,(function(a){return o("li",{key:a,staticClass:"page-item",class:{active:t.pagination.current_page===a},on:{click:function(o){return t.goPage(a)}}},[o("a",{staticClass:"page-link",attrs:{href:"#"}},[t._v(t._s(a))])])})),o("li",{staticClass:"page-item",class:{disabled:!t.pagination.has_next}},[o("a",{staticClass:"page-link",attrs:{href:"#","aria-label":"Next"},on:{click:function(a){return t.goPage(t.pagination.current_page+1)}}},[o("span",{attrs:{"aria-hidden":"true"}},[t._v("»")])])])],2)])},n=[],s={props:["pagination"],methods:{goPage:function(t){this.$emit("gopage",t)}}},i=s,c=o("2877"),l=Object(c["a"])(i,e,n,!1,null,null,null);a["a"]=l.exports},f329:function(t,a,o){"use strict";o.r(a);var e=function(){var t=this,a=t.$createElement,o=t._self._c||a;return o("div",[o("loading",{attrs:{active:t.isLoading},on:{"update:active":function(a){t.isLoading=a}}}),o("div",{staticClass:"text-right py-3"},[o("button",{staticClass:"btn btn-large btn-secondary",on:{click:function(a){return t.openModal(!0)}}},[t._v("新建Coupon")])]),o("table",{staticClass:"table"},[t._m(0),o("tbody",t._l(t.coupons,(function(a){return o("tr",{key:a.id},[o("td",[t._v(t._s(a.title))]),o("td",[t._v(t._s(a.code))]),o("td",[t._v(t._s(t._f("format-time")(a.due_date)))]),o("td",[t._v("\n          "+t._s(a.percent)+"\n          ")]),o("td",[o("a",{staticClass:"btn btn-outline-primary btn-sm",attrs:{href:"#"},on:{click:function(o){return o.preventDefault(),t.openModal(!1,a)}}},[t._v("編輯")]),o("a",{staticClass:"btn btn-outline-danger btn-sm",attrs:{href:"#"},on:{click:function(o){return o.preventDefault(),t.openModal(!1,a,!0)}}},[t._v("刪除")])])])})),0)]),o("pagination",{attrs:{pagination:t.pagination},on:{gopage:t.getCouponsData}}),o("div",{staticClass:"modal fade",attrs:{id:"couponModal",tabindex:"-1",role:"dialog","aria-labelledby":"exampleModalLabel","aria-hidden":"true"}},[o("div",{staticClass:"modal-dialog modal-lg",attrs:{role:"document"}},[o("div",{staticClass:"modal-content border-0"},[o("div",{staticClass:"modal-header bg-dark text-white"},[o("h5",{staticClass:"modal-title",attrs:{id:"couponModalLabel"}},[t.isNew?o("span",[t._v("新增Coupon")]):t._e(),t.isNew?t._e():o("span",[t._v("編輯Coupon")])]),t._m(1)]),o("div",{staticClass:"modal-body"},[o("div",{staticClass:"row"},[o("div",{staticClass:"col-sm-12"},[o("div",{staticClass:"form-group"},[o("label",{attrs:{for:"title"}},[t._v("標題")]),o("input",{directives:[{name:"model",rawName:"v-model",value:t.tempCoupon.title,expression:"tempCoupon.title"}],staticClass:"form-control",attrs:{type:"text",id:"title",placeholder:"請輸入標題"},domProps:{value:t.tempCoupon.title},on:{input:function(a){a.target.composing||t.$set(t.tempCoupon,"title",a.target.value)}}})]),o("div",{staticClass:"form-row"},[o("div",{staticClass:"form-group col-md-12"},[o("label",{attrs:{for:"category"}},[t._v("折數")]),o("input",{directives:[{name:"model",rawName:"v-model",value:t.tempCoupon.percent,expression:"tempCoupon.percent"}],staticClass:"form-control",attrs:{type:"number",id:"category",placeholder:"請輸入折數"},domProps:{value:t.tempCoupon.percent},on:{input:function(a){a.target.composing||t.$set(t.tempCoupon,"percent",a.target.value)}}})]),o("div",{staticClass:"form-group col-md-12"},[o("label",{attrs:{for:"price"}},[t._v("折扣碼")]),o("input",{directives:[{name:"model",rawName:"v-model",value:t.tempCoupon.code,expression:"tempCoupon.code"}],staticClass:"form-control",attrs:{type:"unit",id:"unit",placeholder:"請輸入折扣碼"},domProps:{value:t.tempCoupon.code},on:{input:function(a){a.target.composing||t.$set(t.tempCoupon,"code",a.target.value)}}})]),o("div",{staticClass:"form-group col-md-12"},[o("label",{attrs:{for:"origin_price"}},[t._v("到期日")]),o("input",{directives:[{name:"model",rawName:"v-model",value:t.tempCoupon.due_date,expression:"tempCoupon.due_date"}],staticClass:"form-control",attrs:{type:"date",id:"origin_price",placeholder:"請輸入到期日"},domProps:{value:t.tempCoupon.due_date},on:{input:function(a){a.target.composing||t.$set(t.tempCoupon,"due_date",a.target.value)}}})])])])])]),o("div",{staticClass:"modal-footer"},[o("button",{staticClass:"btn btn-outline-secondary",attrs:{type:"button","data-dismiss":"modal"}},[t._v("取消")]),o("button",{staticClass:"btn btn-primary",attrs:{type:"button"},on:{click:t.updateCoupon}},[t.isLoading?o("i",{staticClass:"fas fa-spinner fa-spin"}):t._e(),t._v("確認\n          ")])])])])]),o("div",{staticClass:"modal fade",attrs:{id:"delcouponModal",tabindex:"-1",role:"dialog"}},[o("div",{staticClass:"modal-dialog",attrs:{role:"document"}},[o("div",{staticClass:"modal-content border-0"},[t._m(2),o("div",{staticClass:"modal-body"},[t._v("\n          是否刪除 "+t._s(t.tempCoupon.title)+" Coupon。\n          "),o("strong",{staticClass:"text-danger"},[t._v("(刪除後將無法恢復)")])]),o("div",{staticClass:"modal-footer"},[o("button",{staticClass:"btn btn-outline-secondary",attrs:{type:"button","data-dismiss":"modal"}},[t._v("取消")]),o("button",{staticClass:"btn btn-danger",attrs:{type:"button"},on:{click:t.removeCoupon}},[t._v("確認刪除")])])])])])],1)},n=[function(){var t=this,a=t.$createElement,o=t._self._c||a;return o("thead",{staticClass:"thead-light"},[o("tr",[o("th",{attrs:{scope:"col"}},[t._v("Coupon名稱")]),o("th",{attrs:{scope:"col",width:"200"}},[t._v("Coupon Code")]),o("th",{attrs:{scope:"col",width:"110"}},[t._v("截止日")]),o("th",{attrs:{scope:"col",width:"80"}},[t._v("折數")]),o("th",{attrs:{scope:"col",width:"130"}},[t._v("編輯")])])])},function(){var t=this,a=t.$createElement,o=t._self._c||a;return o("button",{staticClass:"close",attrs:{type:"button","data-dismiss":"modal","aria-label":"Close"}},[o("span",{attrs:{"aria-hidden":"true"}},[t._v("×")])])},function(){var t=this,a=t.$createElement,o=t._self._c||a;return o("div",{staticClass:"modal-header bg-danger text-white"},[o("h5",{staticClass:"modal-title",attrs:{id:"delcouponModalLabel"}},[o("span",[t._v("刪除Coupon")])]),o("button",{staticClass:"close",attrs:{type:"button","data-dismiss":"modal","aria-label":"Close"}},[o("span",{attrs:{"aria-hidden":"true"}},[t._v("×")])])])}],s=o("1157"),i=o.n(s),c=o("1799"),l={data:function(){return{coupons:[],pagination:{},tempCoupon:{},tempTimestamp:""}},methods:{getCouponsData:function(){var t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:1,a=this;a.$store.dispatch("updateLoading",!0);var o="".concat("https://vue-course-api.hexschool.io","/api/").concat("komu","/admin/coupons?page=").concat(t);a.$http.get(o).then((function(t){console.log("後台取得Coupons資料：",t),a.coupons=t.data.coupons,a.pagination=t.data.pagination,a.$store.dispatch("updateLoading",!1)}))},updateCoupon:function(){var t=this;t.$store.dispatch("updateLoading",!0);var a="".concat("https://vue-course-api.hexschool.io","/api/").concat("komu","/admin/coupon"),o="post";t.isNew||(a="".concat("https://vue-course-api.hexschool.io","/api/").concat("komu","/admin/coupon/").concat(t.tempCoupon.id),o="put"),t.formatTimestamp(t.tempCoupon.due_date);var e=t.tempCoupon;t.$http[o](a,{data:e}).then((function(a){a.data.success?(console.log("updateCoupon:",a),t.$store.dispatch("updateLoading",!1),i()("#couponModal").modal("hide"),t.getCouponsData()):(console.log("更新coupon失敗",a),t.$store.dispatch("updateLoading",!1),i()("#couponModal").modal("hide"))}))},removeCoupon:function(){var t=this;t.$store.dispatch("updateLoading",!0);var a="".concat("https://vue-course-api.hexschool.io","/api/").concat("komu","/admin/coupon/").concat(t.tempCoupon.id);t.$http.delete(a).then((function(a){console.log("deleteCoupons:",a),t.$store.dispatch("updateLoading",!1),a.data.success||console.log(a.data.message),i()("#delcouponModal").modal("hide"),t.getCouponsData()}))},openModal:function(t,a,o){if(t)this.tempCoupon={},this.tempTimestamp="",this.$store.dispatch("updateisNew",!0);else{if(!t&&o)return this.tempCoupon=Object.assign({},a),void i()("#delcouponModal").modal("show");this.tempCoupon=Object.assign({},a),this.formatTime(this.tempCoupon.due_date),this.$store.dispatch("updateisNew",!1)}i()("#couponModal").modal("show")},formatTime:function(t){var a=new Date(1e3*t),o=a.getFullYear(),e=a.getMonth()<10?"0".concat(a.getMonth()+1):a.getMonth()+1,n=a.getDate()<10?"0".concat(a.getDate()):a.getDate();this.tempCoupon.due_date="".concat(o,"-").concat(e,"-").concat(n),console.log("formatTime:",this.tempCoupon.due_date)},formatTimestamp:function(t){var a=new Date(t);this.tempCoupon.due_date=Math.floor(a.getTime()/1e3),console.log("formatTimestamp:",this.tempCoupon.due_date)}},computed:{isLoading:function(){return this.$store.state.isLoading},isNew:function(){return this.$store.state.isNew}},created:function(){this.getCouponsData()},components:{pagination:c["a"]}},p=l,r=o("2877"),d=Object(r["a"])(p,e,n,!1,null,null,null);a["default"]=d.exports}}]);
//# sourceMappingURL=chunk-7e83b537.4307ac7c.js.map